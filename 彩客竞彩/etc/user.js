var cityArray = new Array(); 
cityArray[0] = new Array("北京市","东城区|西城区|崇文区|宣武区|朝阳区|丰台区|石景山|海淀区|门头沟|房山区|通州区|顺义区|昌平区|大兴区|平谷区|怀柔区|密云区|延庆"); 
cityArray[1] = new Array("上海市","黄浦区|卢湾区|徐汇区|长宁区|静安区|普陀区|闸北区|虹口区|杨浦区|闵行区|宝山区|嘉定区|浦东区|金山区|松江区|青浦区|南汇区|奉贤区|崇明");
cityArray[2] = new Array("天津市", "和平区|东丽区|河东区|西青区|河西区|津南区|南开区|北辰区|河北区|武清区|红挢区|塘沽区|汉沽区|大港区|宁河区|静海区|宝坻区|蓟县|滨海新区");
cityArray[3] = new Array("重庆市", "万州区|涪陵区|渝中区|大渡口区|江北区|沙坪坝区|九龙坡区|南岸区|北碚区|万盛区|双挢区|渝北区|巴南区|黔江区|长寿区|綦江县|潼南区县|铜梁县|大足县|荣昌县|壁山县|梁平县|城口县|丰都县|垫江县|武隆县|忠县县|开县县|云阳县|奉节县|巫山县|巫溪县|石柱县|秀山县|酉阳县|彭水县|江津县|合川县|永川县|南川县");
cityArray[4] = new Array("河北省", "石家庄市|邯郸市|邢台市|保定市|张家口|承德市|廊坊市|唐山市|秦皇岛|沧州市|衡水市");
cityArray[5] = new Array("山西省", "太原市|大同市|阳泉市|长治市|晋城市|朔州市|吕梁市|忻州市|晋中市|临汾市|运城市");
cityArray[6] = new Array("内蒙古", "呼和浩特市|包头市|乌海市|赤峰市|通辽市|呼伦贝尔市|阿拉善盟|哲里木盟|兴安盟市|乌兰察布市|锡林郭勒盟|巴彦淖尔市|伊克昭盟|鄂尔多斯市"); 
cityArray[7] = new Array("辽宁省","沈阳市|大连市|鞍山市|抚顺市|本溪市|丹东市|锦州市|营口市|阜新市|辽阳市|盘锦市|铁岭市|朝阳市|葫芦岛");
cityArray[8] = new Array("吉林省", "长春市|吉林市|四平市|辽源市|通化市|白山市|松原市|白城市|延边市"); 
cityArray[9] = new Array("黑龙江","哈尔滨市|齐齐哈尔市|牡丹江市|佳木斯市|大庆市|绥化市|鹤岗市|鸡西市|黑河市|双鸭山市|伊春市|七台河市|大兴安岭市");
cityArray[10] = new Array("江苏省", "南京市|镇江市|苏州市|南通市|扬州市|盐城市|徐州市|连云港|常州市|无锡市|宿迁市|泰州市|淮安市");
cityArray[11] = new Array("浙江省", "杭州市|宁波市|温州市|嘉兴市|湖州市|绍兴市|金华市|衢州市|舟山市|台州市|丽水市");
cityArray[12] = new Array("安徽省", "合肥市|芜湖市|蚌埠市|马鞍山|淮北市|铜陵市|安庆市|黄山市|滁州市|宿州市|池州市|淮南市|巢湖市|阜阳市|六安市|宣城市|亳州市");
cityArray[13] = new Array("福建省", "福州市|厦门市|莆田市|三明市|泉州市|漳州市|南平市|龙岩市|宁德市");
cityArray[14] = new Array("江西省", "南昌市|景德镇|九江市|鹰潭市|萍乡市|新余市|赣州市|吉安市|宜春市|抚州市|上饶市");
cityArray[15] = new Array("山东省", "济南市|青岛市|淄博市|枣庄市|东营市|烟台市|潍坊市|济宁市|泰安市|威海市|日照市|莱芜市|临沂市|德州市|聊城市|滨州市|菏泽市");
cityArray[16] = new Array("河南省", "郑州市|开封市|洛阳市|平顶山市|安阳市|鹤壁市|新乡市|焦作市|濮阳市|许昌市|漯河市|三门峡|南阳市|商丘市|信阳市|周口市|驻马店市|济源市");
cityArray[17] = new Array("湖北省", "武汉市|宜昌市|荆州市|襄樊市|黄石市|荆门市|黄冈市|十堰市|恩施市|潜江市|天门市|仙桃市|随州市|咸宁市|孝感市|鄂州市");
cityArray[18] = new Array("湖南省", "长沙市|常德市|株洲市|湘潭市|衡阳市|岳阳市|邵阳市|益阳市|娄底市|怀化市|郴州市|永州市|湘西市|张家界市");
cityArray[19] = new Array("广东省", "广州市|深圳市|珠海市|汕头市|东莞市|中山市|佛山市|韶关市|江门市|湛江市|茂名市|肇庆市|惠州市|梅州市|汕尾市|河源市|阳江市|清远市|潮州市|揭阳市|云浮市");
cityArray[20] = new Array("广西", "南宁市|柳州市|桂林市|梧州市|北海市|防城港市|钦州市|贵港市|玉林市|南宁地区|柳州地区|贺州市|百色市|河池市|来宾市|崇左市");
cityArray[21] = new Array("海南省", "海口市|三亚市|儋州市|五指山市|文昌市|琼海市|万宁市|东方市|定安县|屯昌县|澄迈县|临高县|琼中县|保亭自治县|白沙县|昌江县|乐东县|陵水县");
cityArray[22] = new Array("四川省", "成都市|绵阳市|德阳市|自贡市|攀枝花市|广元市|内江市|乐山市|南充市|宜宾市|广安市|达州市|雅安市|眉山市|甘孜州|凉山州|泸州市|阿坝州|资阳市|巴中市|遂宁市");
cityArray[23] = new Array("贵州省", "贵阳市|六盘水|遵义市|安顺市|铜仁市|黔西南|毕节市|黔东南|黔南");
cityArray[24] = new Array("云南省", "昆明市|大理市|曲靖市|玉溪市|昭通市|楚雄市|红河市|文山市|普洱市|西双版纳|保山市|德宏市|丽江市|怒江市|迪庆市|临沧市");
cityArray[25] = new Array("西藏", "拉萨市|日喀则地区|山南地区|林芝地区|昌都市|阿里市|那曲市"); 
cityArray[26] = new Array("陕西省","西安市|宝鸡市|咸阳市|铜川市|渭南市|延安市|榆林市|汉中市|安康市|商洛");
cityArray[27] = new Array("甘肃省", "兰州市|嘉峪关市|金昌市|白银市|天水市|酒泉市|张掖市|武威市|定西市|陇南市|平凉市|庆阳市|临夏市|甘南市");
cityArray[28] = new Array("宁夏", "银川市|石嘴山市|吴忠市|固原市|中卫市");
cityArray[29] = new Array("青海省", "西宁市|海东地区|海南藏族自治州|海北藏族自治州|黄南藏族自治州|玉树藏族自治州|果洛藏族自治州|海西蒙古族藏族自治州");
cityArray[30] = new Array("新疆", "乌鲁木齐市|石河子市|克拉玛依市|伊犁哈萨克自治州|巴音郭勒市|昌吉回族自治州|克孜勒苏柯尔克孜自治州|博尔塔拉蒙古自治州|吐鲁番地区|哈密地区|喀什地区|和田地区|阿克苏地区"); 
cityArray[31] = new Array("香港","香港特别行政区"); 
cityArray[32] = new Array("澳门","澳门特别行政区");
cityArray[33] = new Array("台湾省", "台北市|高雄市|台中市|台南市|屏东市|南投市|云林市|新竹市|彰化县|苗栗县|嘉义县|花莲县|桃园县|宜兰县|基隆市|台东县|金门县|马祖县|澎湖县"); 
function getCity(currProvince) 
{ 
     //清空 城市 下拉选单 
     for (var i = 0 ;i <cityArray.length;i++) 
       {    
         //得到当前省份的城市数组
         if(cityArray[i][0]==currProvince) 
         {    
            return cityArray[i][1];
         } 
       }
}
function initBnkMag()
{
    $("#dvSelBank").css({"width":"98%","padding": "5px","textAlign":"left","background":"#FDFCF2","color":"#C61D00","border":"solid 1px #ECECEC","visibility":"hidden"});
    $("#tbBank").css({"cursor":"pointer"}).click(function(){ 
         ModalEffectsOpen("dvSelBank");
    });
    $("#dvSelProvince").css({"width":"98%","padding": "5px","textAlign":"left","background":"#FDFCF2","color":"#C61D00","border":"solid 1px #ECECEC","visibility":"hidden"});
     $("#dvSelCity").css({"width":"98%","padding": "5px","textAlign":"left","background":"#FDFCF2","color":"#C61D00","border":"solid 1px #ECECEC","visibility":"hidden"});
    $("#tbProvince").css({"cursor":"pointer"}).click(function(){ 
         ModalEffectsOpen("dvSelProvince");
    });
}
//填充数据
function putValue(name,v)
{ 
   if(arguments.length>0){
       $("#"+name).text(v);
       $("#hd"+name).val(v);
   }
   if (name=="currBank"){
       if(v.indexOf("工商") != -1 || v.indexOf("招商") != -1 || v.indexOf("农业") != -1 || v.indexOf("建设") != -1 || v.indexOf("交通") != -1 || v.indexOf("中信") != -1 || v.indexOf("光大") != -1 || v.indexOf("广发") != -1 || v.indexOf("民生") != -1)
       {
            $("#dvBankPc").hide();
            $("#dvBankCt").hide();
            $("#dvBankAddr").hide();
       }
       else
       {
            $("#dvBankPc").show();
            $("#dvBankCt").show();
            $("#dvBankAddr").show();
       }
   }
   else if(name == "currProvince")
   {
        $("#currCity").text("请选择城市");
        var arrCitys = getCity(v).split("|"); 
        var html = "<div style='font-weight:bold;color:#000000;background:#FFFFFF;line-height:36px;'><div style='float:right;padding:0 4px;'><a href='javascript:' onclick='putValue();return false;'> <img src='/images/menu/yl_close.png' align='absmiddle'></a></div><span style='margin-left:15px;font-size:16px;'>请选择以下城市：</span></div><div class='list_d'><table width='100%'>";
        for(var i=0;i<arrCitys.length;i++){
            html +="<tr><td width='50%'><a href='javascript:' onclick=putValue('currCity','"+arrCitys[i]+"'); >"+arrCitys[i]+"</a></td>                      <td>"+((i+1)<arrCitys.length?"<a href='javascript:' onclick=putValue('currCity','"+arrCitys[i+1]+"'); >"+arrCitys[i+1]+"</a>":"")+"</td></tr>";
        }
        html +="</table></div>";
        $("#dvSelCity").html(html);
        $("#tbCity").css({"cursor":"pointer"}).click(function(){ 
             ModalEffectsOpen("dvSelCity");
        });
   }
   closeModal();
}
//#region 

//初始化
function initDataInfo()
{
    $("body").css({'background-color':'#FFFCF7'});
    $("#dvLoadMore").html("<img src='/images/loading.gif' align='absmiddle'>"); 
    var loadPosition = $(window).height() - $("#dvTopBar").height() + "px"; 
    $("#dvLoadMore").css({"line-height":loadPosition,"height":loadPosition});
    $(window).scroll(function (){  
        if(($(window).height() + $(window).scrollTop())+ 60 >= $("body").height())//滚动条是否已移动到底
            showMoreData(); 
    });  
    $("#dvLoadMore").click(function(){
        showMoreData();
    });
    showMoreData();
}
//显示数据
function showMoreData()
{
   page +=1;
   var t_row = 0;
   $("#dvLoadMore").css({"line-height":"42px","height":"42px"});
   $("#dvDataList tr").each(function(index){
       if(index<=page*20 )
         if($(this).css("display")=="none") $(this).show();
   });
   if($("#dvDataList tr").length<20){
       $("#dvLoadMore").hide();
   }
   else{ 
       $("#dvLoadMore").show();
   }
    $("#dvDataList tr").each(function(){
       if($(this).css("display")=="table-row")
          t_row +=1;
   });
   if(t_row == $("#dvDataList tr").length) {
        $(".c_prunc").css({"margin-bottom":"28px"});
        $("#dvLoadMore").hide();
   }
}
function toHref(url)
{
     return "location.href='"+url+"'";
}
//弹出框
var promptBox = function(tips,url){
    var htmlf = "<table width='100%' style='BORDER-COLLAPSE: collapse' cellspacing='1' cellpadding='2' class='w_tips'><tr><td>{tips}</td></tr><tr><td><input type='button' class='long_btn yelbg' onclick={url} value='确定' /></td></tr></table>";
    this.set = function(c){
         if(c != undefined)
            htmlf = c;
    };
    this.showBox=function()
    {
       htmlf = htmlf.replace("{tips}",tips);
       htmlf = htmlf.replace("{url}",url);
       $("#resultWin").html(htmlf);  
        setTimeout(function(){  
            ModalEffectsOpen("resultWin");
       },1000);
    };
};

//传递框内容并弹出
function showResult(t,u,content){
    var p = new promptBox(t,u);
    p.set(content);
    p.showBox();
}
//#endregion
$(function(){
    isHidden = (location.href.toLowerCase().indexOf("wc.310win.com")!=-1); 
    try{
        if(parseInt(getCookie("coperid"))==294){
            $("#topleftBack").hide();
            isHidden = true; 
        }else{
            $("#topleftBack").show();
        }
        if(isHidden) {
            $(".t_lout2").hide();
        }
    }catch (e) { alert(e);}
});
/*********************  用户注册 ****************************/
/*********************短信倒计时******************************/
var ckNowTime; //服务器时间
var ckDiff; //服务器和客户机时差
var ckStopTime; //截止时间
var leaveObj;
//异步发送短信
function sycSendVerifyCode() {
    if (username.value == "") {
        alert("请在用户名处输入手机号码");
        username.focus();
        return;
    }
    if (txtKey.value == "")
    {
        alert("请输入验证码");
        txtKey.focus();
        return;
    }
    $("#btnSendVfCode").disabled = "disabled";
    $.ajax({
        type: "POST",
        cache: false,
        data: "cmd=sendvfcode&username=" + escape(username.value) + "&key=" + escape(txtKey.value),
        success: function (r) {
            if (r == "success") {
                var sDate = new Date();
                var endDate = sDate.getTime() + (60 * 1000);
                startClock("btnSendVfCode", sDate.getTime(), endDate);
            } else {
                alert(r);
                $("#btnSendVfCode").disabled = false;
                initRefCode();
            }
        },
        error: function (r) {
            loadLogin();
            $("#btnSendVfCode").disabled = false;
        },
        complete: function (XHR, TS) { XHR = null; }
    });
    return false;
}
function startClock(id, nowtime, stoptime) {
    ckNowTime = new Date(nowtime);
    ckStopTime = new Date(stoptime);
    ckDiff = ckStopTime - ckNowTime;
    if (leaveObj)
        clearInterval(leaveObj);
    leaveObj = setInterval("reverseTime('" + id + "')", 1000);
}
function reverseTime(id) {
    var leave = ckDiff;
    var second = Math.floor(leave / (1000));
    ckDiff = ckDiff - 1000;
    var spLv = document.getElementById(id);
    if (leave > 0) { //还未停止
        if (spLv) { spLv.value = "等待" + second + "秒"; spLv.style.backgroundColor = "#c4c4c3"; spLv.disabled = true; }
    }
    else { //已停止
        if (spLv) { spLv.value = "获取验证码"; spLv.style.backgroundColor = "#FFAA01"; spLv.disabled = false; }
    }
}
/*****************************************************************/
//检查填写项
function sycCheckInput(cname, cvalue, tip, pwd) {
    $.ajax({
        type: "POST",
        cache: false,
        data: "cmd=chk" + cname + "&" + cname + "=" + escape(cvalue) + (cname == "repwd" ? "&pwd=" + pwd : ""),
        success: function (r) {
            var resultObj = eval('(' + r + ')');
            if (resultObj != null && resultObj != 'undefined') {
                if (parseInt(resultObj.issuccess) == 1) { //验证用户名成功
                    tip.innerText = resultObj.feedback;
                    if (cname == "username") {//以下根据用户名项填写判断（如手机号则显示）
                        if (parseInt(resultObj.isshowvf) == 1)//显示短信验证码输入
                            trVfCode.style.display = "";
                        else
                            trVfCode.style.display = "none";
                    }
                } else {

                    tip.innerText = resultObj.feedback;
                }
            }
        },
        error: function (r) {
            loadLogin();
        },
        complete: function (XHR, TS) { XHR = null; }
    });
    return false;
}
//提交注册
function sycOnSubmit(objForm) {
    if (objForm.username.value == "") {
        $("#dvMsgUserName").text("请输入用户名");
        return;
    }
    if (objForm.pwd.value == "") {
        $("#dvMsgPwd1").text("请输入用户密码");
        return;
    }
    if (objForm.repwd.value == "") {
        $("#dvMsgPwd2").text("请确认用户密码");
        return;
    }
    var expconference = ""; 
    if (objForm.realname != undefined) {
        if (objForm.realname.value == "") {
            $("#dvMsgRealName").text("请输入真实姓名");
            return;
        }
        expconference += "&realname=" + escape(objForm.realname.value);
    }
    if (objForm.idnumb != undefined) {
        if (objForm.idnumb.value == "") {
            $("#dvMsgIDNumb").text("请输入身份证号");
            return;
        }
        expconference += "&idnumb=" + escape(objForm.idnumb.value);
    }
    
    if (document.getElementById("trVfCode").style.display == "") {
        if (objForm.vfcode.value == "") {
            $("#dvMsgCode").text("请输入验证码");
            return;
        }
        expconference += "&vfcode=" + escape(objForm.vfcode.value);
    }
    var uid = GetQueryString("UID");
    $.ajax({
        type: "POST",
        cache: false,
        //url: "../user/Register.aspx?" + Math.random(),
        data: "subact=onsubmit&username=" + escape(objForm.username.value) + "&pwd=" + escape(objForm.pwd.value) + "&repwd=" + escape(objForm.repwd.value) + "&readdeclare=" + (objForm.cbxReadDeclare.checked ? 1 : 0) + expconference + (uid != null? "&UID=" + uid : ""),
        success: function (r) {
            if (r != "") {
                var resultObj = eval('(' + r + ')');
                if (resultObj != null && resultObj != undefined) {
                    if (parseInt(resultObj.regsuccess) == 1) { //注册成功
                        if (resultObj.message == "")
                            location.href = resultObj.tranferurl;// 跳转到成功页
                    }
                    else if (parseInt(resultObj.regsuccess) == 2) { //球探用户注册成功
                        $("#regForm").hide();
                        $(".bottomTips").html("<div style=\"width: 100 %; text - align:center; color:#ea3c3c; font-size:16px; padding-top:10px; padding-bottom:8px;\">注册成功，<a href='http://zhushou.360.cn/detail/index/soft_id/3191897'>请点击下载球探彩票客户端</a>，用您的账号直接登录系统</div>");
                    }
                    else {
                        $("#dvMsgCode").text(resultObj.message);
                    }
                }
            }
        },
        error: function (r) {
            $("#err_userid").html("发生未知异常:" + r);
            $("#divLogin").show();
            return false;
        },
        complete: function (XHR, TS) { XHR = null; }
    });
    return false;
}

function GetQueryString(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
    var r = window.location.search.substr(1).match(reg);
    if (r != null) return unescape(r[2]); return null;
}